#include  <stdio.h>
#include  <stdlib.h>
#include  <iostream>
#include  <cstring>
#include  <math.h>
#include  <time.h>
#include  <string.h>
#include  <limits.h>
#include  <chrono>

#include <fstream>

#include <cuda.h>

#include <cuda_runtime.h>
#include <cuda_runtime_api.h>

#include <builtin_types.h>

using namespace std;

//#include "./ldpc/CFloodingGpuDecoder.h"
//#include "./ldpc/ADMM_GPU_Decoder.h"
//#include "./ldpc/ADMM_GPU_Decoder_16b.h"
#include "./ldpc/ADMM_GPU_decoder_64b.h"
//#include "./ldpc/ADMM_GPU_16b.h"

#define pi  3.1415926536

#include "./cpp_src/CTimer/CTimer.h"
#include "./cpp_src/CTrame/CTrame.h"
#include "./cpp_src/CChanel/CChanelAWGN2.h"
#include "./cpp_src/CEncoder/CFakeEncoder.h"
#include "./cpp_src/CErrorAnalyzer/CErrorAnalyzer.h"
#include "./cpp_src/CTerminal/CTerminal.h"

#define SINGLE_THREAD 1

#if 0
	#define NOEUD       4000
	#define PARITE      2000
	#define MESSAGE     12000
#else
	#define NOEUD       2640
	#define PARITE      1320
	#define MESSAGE     7920
#endif


////////////////////////////////////////////////////////////////////////////////////


/*void printDeviceProp(const cudaDeviceProp &prop)
{
    printf("Device Name : %s\n", prop.name);
    printf("totalGlobalMem : %ld\n", prop.totalGlobalMem);
    printf("sharedMemPerBlock : %ld\n", prop.sharedMemPerBlock);
    printf("regsPerBlock : %d\n", prop.regsPerBlock);
    printf("warpSize : %d\n", prop.warpSize);
    printf("memPitch : %ld\n", prop.memPitch);
    printf("maxThreadsPerBlock : %d\n", prop.maxThreadsPerBlock);
    printf("maxThreadsDim [x,y,z] : %d %d %d\n", prop.maxThreadsDim[0], prop.maxThreadsDim[1], prop.maxThreadsDim[2]);
    printf("maxGridSize [x,y,z] : %d %d %d\n", prop.maxGridSize[0], prop.maxGridSize[1], prop.maxGridSize[2]);
    printf("totalConstMem : %ld\n", prop.totalConstMem);
    printf("major.minor : %d.%d\n", prop.major, prop.minor);
    printf("clockRate : %d\n", prop.clockRate);
    printf("textureAlignment : %ld\n", prop.textureAlignment);
    printf("deviceOverlap : %d\n", prop.deviceOverlap);
    printf("multiProcessorCount : %d\n", prop.multiProcessorCount);
    printf("maxThreadsPerMultiProcessor : %d\n", prop.maxThreadsPerMultiProcessor);
    printf("pciBusID : %d\n", prop.pciBusID);
    printf("pciDeviceID : %d\n", prop.pciDeviceID);
    printf("pciDomainID : %d\n", prop.pciDomainID);
    printf("computeMode  : %d\n", prop.computeMode);   
}*/
//CUDA 初始化
/*bool InitCUDA()
{
    int count;

    //取得支持Cuda的装置的数目
    cudaGetDeviceCount(&count);

    //没有符合的硬件
    if (count == 0) {
        fprintf(stderr, "There is no device.\n");
        return false;
    }

    int i;

    for (i = 0; i < count; i++) {
        cudaDeviceProp prop;
        if (cudaGetDeviceProperties(&prop, i) == cudaSuccess) {
            if (prop.major >= 1) {
                break;
            }
        }
    }

    if (i == count) {
        fprintf(stderr, "There is no device supporting CUDA 1.x.\n");
        return false;
    }

    cudaSetDevice(1);
    printf("We choose Device %d for test :\n",i);

    return true;
}*/

int main(int argc, char* argv[])
{

        /*if (!InitCUDA()) 
    { 
        return 0; 
    }

        printf("CUDA initialized.\n");*/
 
	int p;
        srand( 0 );
	printf("(II) LDPC DECODER - Flooding scheduled decoder\n");
	printf("(II) MANIPULATION DE DONNEES (IEEE-754 - %ld bits)\n", 8*sizeof(int));
	printf("(II) GENEREE : %s - %s\n", __DATE__, __TIME__);



/////////////////////

	int    FRAME_ERROR_LIMIT =  100;
	double BIT_ERROR_LIMIT   =  1e-7;

	double snr_min  = 0.50;
	double snr_max  = 4.51;
	double snr_step = 0.50;

	//int algo                  = 0;
        int NOMBRE_ITERATIONS     = 200;
	//int REAL_ENCODER          =  0;
	int STOP_TIMER_SECOND     = -1;
        int NB_FRAMES_IN_PARALLEL =  1;
	bool QPSK_CHANNEL         = false;
        bool Es_N0                = false;
	bool BER_SIMULATION_LIMIT = false;
	int  codewords            = 1000;//1000000000




       // int startDevice = 0;
       // int endDevice = 0;

////device option1 
       /*int deviceCount;
       cudaGetDeviceCount(&deviceCount);
       int device;
    
    for (device = 0; device < deviceCount; ++device) {
         cudaDeviceProp deviceProp;
         cudaGetDeviceProperties(&deviceProp, device);
         cudaGetDeviceProperties(&deviceProp, device);
         printf("\n");
         printf("Device %d Information :\n",device);
         printDeviceProp(deviceProp);
         printf("\n");
         printf("We choose Device %d for test :\n",device);
         printf("\n");
         cudaSetDevice(1);
         cudaDeviceSynchronize();
         cudaThreadSynchronize();
    }*/

///device option2
/*int numDevices = 0;  
cudaGetDeviceCount(&numDevices);  
if (numDevices > 0) {  
    int maxMultiprocessors = 0, maxDevice = 0;  
    for (int device=0; device<numDevices; device++) {  
        cudaDeviceProp props;  
        cudaGetDeviceProperties(&props, device);  
        if (maxMultiprocessors < props.multiProcessorCount) {  
            maxMultiprocessors = props.multiProcessorCount;  
            maxDevice = device;  
        }  
     printf("Device %d Information :\n",device);
     printDeviceProp(props);
     printf("\n");
    }  
    cudaSetDevice(maxDevice); 
    //printf("Device %d Information :\n",maxDevice);
    printf("We choose Device %d for test :\n",maxDevice);
    printf("\n");
    
    
//cudaDeviceSynchronize();
cudaThreadSynchronize();
}  */
         cudaSetDevice(0);
        

        // cudaDeviceSynchronize();
        cudaThreadSynchronize();

 

	//
	// ON VA PARSER LES ARGUMENTS DE LIGNE DE COMMANDE
	//
	for (p=1; p<argc; p++) {
		if( strcmp(argv[p], "-min") == 0 ){
			snr_min = atof( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-max") == 0 ){
			snr_max = atof( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-step") == 0 ){
			snr_step = atof( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-frames") == 0 ){
			NB_FRAMES_IN_PARALLEL = atoi( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-timer") == 0 ){
			STOP_TIMER_SECOND = atoi( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-random") == 0 ){
            srand( time(NULL) );

		}else if( strcmp(argv[p], "-iter") == 0 ){
			NOMBRE_ITERATIONS = atoi( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-codewords") == 0 ){
			codewords = atoi( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-fer") == 0 ){
			FRAME_ERROR_LIMIT = atoi( argv[p+1] );
			p += 1;

		}else if( strcmp(argv[p], "-qef") == 0 ){
			BER_SIMULATION_LIMIT =  true;
			BIT_ERROR_LIMIT      = ( atof( argv[p+1] ) );
			p += 1;

		}else if( strcmp(argv[p], "-bpsk") == 0 ){
			QPSK_CHANNEL = false;

		}else if( strcmp(argv[p], "-qpsk") == 0 ){
			QPSK_CHANNEL = true;

		}else if( strcmp(argv[p], "-Eb/N0") == 0 ){
			Es_N0 = false;

		}else if( strcmp(argv[p], "-Es/N0") == 0 ){
			Es_N0 = true;

        }else{
			printf("(EE) Unknown argument (%d) => [%s]\n", p, argv[p]);
			exit(0);
		}
	}

	double rendement = (double)(NOEUD-PARITE)/(double)(NOEUD);
        printf("\n");
	printf("(II) Code LDPC (N, K)     : (%d,%d)\n", NOEUD, PARITE);
	printf("(II) Rendement du code    : %.3f\n", rendement);
	printf("(II) # ITERATIONs du CODE : %d\n", NOMBRE_ITERATIONS);
        printf("(II) FER LIMIT FOR SIMU   : %d\n", FRAME_ERROR_LIMIT);
	printf("(II) SIMULATION  RANGE    : [%.2f, %.2f], STEP = %.2f\n", snr_min,  snr_max, snr_step);
	printf("(II) MODE EVALUATION      : %s\n", ((Es_N0)?"Es/N0":"Eb/N0") );

	CTimer simu_timer(true);
	CTrame simu_data_1(NOEUD, PARITE, NB_FRAMES_IN_PARALLEL);

double data[] = {-11.942171
,4.725093
,-3.838541
,2.451868
,4.620082
,-6.398451
,-9.392290
,3.351381
,13.650302
,-10.063483
,6.870246
,-10.853205
,-6.002278
,-3.156492
,-3.824628
,-5.693539
,3.868392
,-2.014534
,-6.680643
,-5.695627
,10.078518
,7.973327
,-7.979416
,7.365306
,8.305610
,-5.058239
,4.039267
,-5.257346
,9.041677
,-8.528903
,-6.601253
,-5.569113
,-0.234690
,-7.877485
,3.122474
,-9.432831
,8.203575
,-5.911884
,-5.959830
,-6.934169
,6.034318
,3.544132
,-6.329751
,-1.302890
,4.302425
,-0.297494
,6.217102
,6.427050
,5.004994
,-1.181241
,-5.401752
,8.830114
,5.857239
,-3.129881
,10.481003
,-4.497982
,-5.163810
,3.979249
,-4.993964
,-7.647370
,-6.944830
,3.086072
,-7.937862
,6.948604
,4.013066
,11.432427
,4.061792
,-6.450129
,5.337478
,-2.993225
,-3.663225
,6.576262
,-5.320109
,0.137963
,5.554266
,4.125654
,2.514168
,5.583448
,-5.352513
,7.474163
,-5.989013
,7.298398
,3.300010
,-1.084545
,8.084799
,-1.624036
,-4.476573
,-4.157123
,-7.899352
,10.577650
,-5.701365
,-5.994780
,4.978021
,-4.534881
,-11.602738
,-5.789897
,3.088012
,10.091142
,6.958639
,-8.960664
,-2.899856
,0.804890
,9.488096
,-1.477663
,11.279646
,7.813503
,9.079159
,-1.985214
,4.432114
,-6.940241
,-0.746371
,-5.910037
,8.327478
,9.890489
,1.259784
,5.587448
,3.541488
,-1.917281
,2.599985
,-6.596837
,-2.496226
,-13.620593
,-6.722390
,3.650885
,8.261112
,8.909928
,6.500412
,3.623212
,0.088562
,-4.714094
,8.383750
,12.508881
,-3.046072
,6.798230
,-4.437915
,-5.830451
,-3.144976
,-3.716818
,-4.789534
,4.588396
,9.801564
,-8.419899
,3.217232
,8.231961
,-4.321048
,-11.487479
,-11.492364
,-3.844346
,-7.215111
,7.714928
,7.204493
,5.265608
,1.969691
,6.422368
,7.807577
,-6.589952
,-4.257576
,5.801479
,7.437035
,2.270464
,3.191574
,5.523642
,12.524340
,3.458529
,-3.163657
,-9.364837
,7.867289
,-5.470881
,7.282643
,-3.039740
,-3.461370
,0.312622
,-4.070548
,-0.037062
,-7.382030
,-5.708333
,-0.903957
,-3.483299
,-7.374576
,2.497412
,-9.449553
,-6.102289
,-9.499234
,11.880038
,7.245711
,9.250001
,-2.653058
,-3.100495
,-5.817173
,-9.845471
,7.352213
,3.760765
,0.968493
,-6.952492
,12.098676
,-11.017667
,13.296977
,6.451188
,-8.842196
,-0.607530
,-3.797212
,-9.853031
,4.473917
,-10.331298
,6.598353
,1.038006
,-7.430450
,-10.696457
,4.640318
,-3.673465
,-1.803857
,5.864788
,-9.002882
,6.599898
,-1.890487
,-8.246884
,-6.053088
,-5.485491
,6.464994
,0.498695
,-8.389658
,2.530529
,4.220517
,-2.631458
,-10.440911
,-2.904657
,-1.962706
,1.111923
,-2.401621
,-1.377131
,-7.908659
,10.621102
,8.101184
,-3.796270
,4.587653
,-0.738949
,7.637671
,-10.577532
,-6.465035
,-3.184688
,7.003286
,8.044855
,-8.712451
,-7.458917
,8.710902
,-2.099342
,-7.931729
,10.070483
,0.675301
,-3.797369
,5.871187
,-1.522982
,-5.634441
,-8.950859
,-4.864786
,3.171239
,-4.379504
,1.673090
,3.692744
,-14.534483
,-8.556628
,-10.724229
,-8.635891
,-7.201326
,4.921505
,7.975870
,-10.084295
,-1.398916
,3.938201
,4.926573
,8.034959
,-7.092121
,1.840830
,-7.638066
,4.501737
,5.031801
,10.016839
,-5.942627
,8.369854
,-6.004635
,12.553255
,-8.375131
,-9.329350
,9.674788
,3.093355
,-1.387454
,-7.364669
,-4.462841
,7.636765
,-3.475478
,-2.692919
,6.106377
,-6.851013
,5.139345
,3.137488
,-8.429349
,2.197495
,5.784409
,6.929034
,-5.052837
,-12.396754
,11.217902
,12.448247
,-5.422582
,1.400859
,-5.985817
,2.839161
,5.197325
,-5.194658
,-5.378582
,-8.494936
,-10.632324
,-5.878943
,7.951724
,4.224812
,-5.593072
,4.223425
,-6.648733
,7.490459
,-4.366777
,8.265965
,2.087944
,-11.787947
,3.813864
,4.652898
,8.177858
,5.022833
,3.742368
,4.505306
,1.835319
,-8.387989
,6.211156
,-4.907472
,-4.765987
,-4.933626
,6.145549
,-5.420162
,-2.476641
,1.802042
,2.903764
,-8.923419
,3.703836
,8.960959
,-7.095090
,-3.626783
,0.457922
,-2.366031
,-7.014113
,9.341308
,10.620756
,6.376799
,0.730453
,-9.305478
,4.168932
,-3.637944
,-1.426329
,8.848469
,-3.188509
,3.677349
,0.578876
,6.526999
,5.404852
,-4.749924
,-8.063526
,0.028348
,7.044224
,-10.336888
,-5.816219
,-1.153015
,5.676248
,-10.592369
,-9.169913
,-11.154257
,8.797739
,6.004956
,-10.594486
,-8.166174
,7.657643
,-2.698159
,-9.343614
,2.146387
,11.858924
,-3.112164
,6.504568
,-2.480335
,-10.546134
,1.834266
,-1.457732
,-9.526362
,-1.713763
,9.819582
,2.731909
,-3.333283
,5.691330
,-3.615752
,6.912709
,7.159600
,-2.740245
,2.579071
,-3.458060
,6.163606
,-7.394673
,-1.523780
,-0.373805
,-4.702027
,8.740213
,-1.870278
,-3.062993
,1.373183
,5.751496
,-8.702808
,1.289168
,-7.406207
,-5.557638
,-2.445994
,-4.953050
,5.143896
,-6.136294
,10.336152
,-6.264152
,-7.152355
,-0.051836
,6.115971
,5.737834
,-4.826683
,-3.384733
,-6.548263
,-4.534344
,-3.306355
,1.825905
,-4.688790
,5.316772
,-2.271526
,8.073152
,5.368050
,11.384162
,6.982958
,-12.149523
,-2.835970
,4.641698
,6.877839
,-3.617280
,-0.793111
,2.643500
,-3.444778
,0.563405
,-6.804182
,0.093763
,5.894225
,5.052181
,-1.959566
,-7.345518
,-7.842510
,8.324780
,3.401979
,-4.938824
,2.248911
,-5.235971
,-10.379349
,10.785028
,2.801299
,1.309823
,11.352757
,4.601356
,6.181933
,-5.488461
,7.935107
,-4.925598
,-3.714903
,-10.122087
,4.513186
,6.922993
,0.080773
,-0.024366
,8.113770
,-9.551261
,-7.718369
,-4.759564
,-6.333397
,6.107056
,-3.641610
,2.947540
,3.944644
,-3.803540
,-3.545553
,-5.790692
,6.661342
,7.932336
,0.295164
,10.881128
,-1.357115
,-4.113941
,-0.250366
,4.899993
,3.103677
,-5.861686
,-10.316862
,7.443377
,-4.395387
,2.443191
,-8.236990
,3.018374
,9.910636
,-5.586533
,6.658095
,-3.930610
,7.736815
,-0.104480
,3.642564
,4.479822
,-2.718346
,4.750175
,8.743655
,-8.187939
,-6.458073
,8.786105
,-8.204393
,-6.865597
,-3.154839
,-13.598229
,-7.802146
,5.201655
,1.606040
,7.001973
,-2.695910
,1.839337
,-7.159389
,1.437216
,-7.206773
,-5.521480
,4.166019
,-7.364347
,-3.321831
,6.715915
,-7.089256
,-10.838570
,-6.661888
,4.444673
,-1.217381
,10.309063
,1.464922
,4.737565
,-3.308449
,-3.911704
,6.858871
,-0.348914
,-14.305042
,-1.314121
,8.755013
,9.525688
,-5.945852
,9.741096
,-10.013461
,-7.613658
,8.308045
,-6.044670
,0.183876
,5.844054
,8.493383
,-7.145796
,6.924974
,7.166722
,-4.988267
,-7.489009
,7.347291
,14.602675
,-12.628168
,-4.435506
,4.046027
,-12.902102
,-0.258264
,-0.145008
,6.908293
,8.141486
,8.999411
,8.532381
,0.738501
,3.429308
,-7.113405
,-7.826685
,5.953918
,4.722496
,7.713876
,2.251069
,7.294332
,3.515702
,9.329858
,6.571115
,-4.764373
,-5.472079
,-9.028071
,-3.817049
,-9.687617
,-5.216801
,-10.425960
,-5.976104
,-6.636563
,0.238975
,6.712706
,-6.208697
,-5.524604
,0.093812
,2.920445
,-3.117597
,-4.186223
,6.727822
,4.666441
,-12.298396
,-9.679545
,12.807533
,-9.700381
,4.619663
,5.930943
,-3.387287
,-7.055596
,-7.010210
,-3.603149
,-10.380691
,8.138207
,3.655604
,6.057093
,-6.984469
,-8.124134
,4.746241
,5.239899
,7.496227
,5.527802
,10.318419
,-5.028876
,-3.261719
,2.092204
,-13.692640
,-10.315476
,-2.744042
,-10.210792
,-1.285538
,0.036711
,-9.104490
,-10.240273
,7.399417
,-10.930492
,8.603743
,-1.096029
,8.199847
,2.347134
,-0.246777
,5.606672
,6.820487
,-7.998474
,-1.034384
,6.180606
,9.164861
,9.681069
,-10.145653
,-5.791250
,-7.147319
,-4.389643
,7.143296
,-6.540234
,-6.882035
,-4.711258
,3.164809
,-3.078732
,6.927917
,-1.169355
,7.867131
,-2.581061
,-9.492042
,8.227065
,6.773510
,-2.517581
,-4.659321
,-5.134555
,-11.514856
,7.994906
,6.032674
,5.437304
,8.318697
,-5.319138
,5.340471
,0.851460
,-2.914900
,6.081369
,3.964109
,-4.031786
,-4.017765
,9.397367
,0.626970
,11.302609
,-3.670815
,0.181462
,-10.363375
,6.647110
,1.863076
,2.794619
,-6.080737
,-3.544182
,-7.837188
,-7.002904
,-1.488144
,13.172708
,0.358593
,8.878726
,-4.589443
,5.376769
,-9.384410
,-6.563969
,-3.377769
,-2.998588
,-3.111796
,-5.586906
,9.107169
,5.921804
,5.615670
,3.129377
,2.524575
,-4.151389
,-7.832038
,-3.032627
,6.958397
,-5.624932
,-9.906861
,-1.114738
,-6.297528
,4.807116
,2.516711
,5.847569
,-10.975865
,8.286552
,-5.426823
,9.179987
,-13.547396
,-12.357921
,-7.848614
,-6.873161
,-14.240426
,-3.626395
,6.071157
,2.386467
,1.538237
,4.697227
,4.331659
,-7.426606
,-6.424709
,-5.662262
,6.020383
,9.006235
,-3.831105
,7.408910
,9.477454
,-5.241974
,-3.754783
,-1.038056
,2.355894
,-4.374682
,5.467450
,2.559288
,8.103733
,-6.519497
,0.518556
,7.696460
,-4.829151
,5.161987
,0.725296
,1.994853
,-1.804368
,-2.606878
,-4.567300
,3.150438
,-7.635639
,4.378004
,-4.169220
,-2.040132
,7.797483
,7.332504
,-10.649449
,4.795464
,1.298921
,3.729315
,-7.029748
,8.094022
,-0.602973
,13.845750
,-5.813727
,-4.388724
,3.400590
,6.709379
,-5.961384
,-4.131809
,-6.750422
,8.081539
,9.148100
,8.354859
,6.848908
,-6.819050
,-0.400957
,-10.444120
,-9.728823
,9.141588
,15.405228
,5.318139
,4.614713
,-3.801335
,-6.514572
,-7.555649
,-1.230566
,4.283808
,-0.501656
,1.732788
,-4.186987
,-1.872836
,-2.204149
,-6.521042
,-6.609015
,7.822191
,-10.500408
,-9.382017
,7.222096
,-8.660770
,-7.795595
,3.452536
,-8.853189
,4.200213
,5.828284
,7.903695
,-4.514139
,-3.188073
,8.882223
,-4.906095
,-4.894733
,10.427818
,-4.716112
,-5.548465
,2.101639
,-5.670688
,-2.654823
,-8.644737
,-7.604052
,-5.638913
,-8.760725
,-5.916910
,-7.795251
,6.200161
,3.251899
,4.511382
,9.150424
,4.058947
,-0.593119
,-9.835638
,-5.727760
,6.198986
,-10.380245
,-5.915956
,5.655449
,6.862355
,-7.288352
,4.602242
,4.788168
,-0.940187
,9.514971
,-2.520875
,8.391887
,-3.722524
,-6.409859
,-6.042089
,1.720893
,-6.000880
,-4.017897
,7.715620
,-5.372388
,3.255054
,7.578946
,10.588089
,-9.399401
,-6.425492
,4.194423
,5.388443
,1.836871
,-5.583472
,-7.147579
,-11.562568
,7.269399
,10.750303
,-2.462445
,-3.947978
,3.892805
,-5.554996
,2.222640
,0.856993
,-4.660482
,7.979301
,-1.856367
,12.648843
,-2.365447
,3.963195
,-5.725897
,5.833278
,13.213079
,7.981600
,9.312878
,1.164503
,-2.739086
,-4.459573
,5.591490
,-8.809884
,6.477909
,-0.535353
,3.626105
,3.514901
,5.158219
,-4.064692
,-8.008550
,-2.833268
,2.653866
,6.718041
,-7.549082
,7.220454
,4.058664
,-17.670845
,6.925833
,8.875527
,9.586881
,8.448438
,-0.782901
,7.200377
,-10.435763
,9.039791
,-2.328723
,-3.314267
,-2.580644
,-6.460914
,-3.491702
,5.729483
,3.669733
,-1.292684
,4.151363
,-6.244619
,2.143873
,-9.799973
,6.462513
,-3.222400
,-3.141922
,-4.514250
,4.228151
,-4.916447
,-3.616697
,6.967769
,6.274965
,-1.536344
,-6.741470
,3.624320
,2.363702
,1.806455
,-12.693712
,-12.399248
,-0.438172
,-3.133653
,0.764299
,2.739696
,-6.900985
,0.610713
,0.327756
,1.386907
,8.115511
,-3.140424
,3.186818
,3.368155
,7.760216
,3.196535
,2.806746
,-3.897916
,2.925339
,7.336343
,-7.084149
,6.822289
,9.829123
,-1.905528
,5.243357
,-3.058105
,15.561548
,4.650061
,5.168786
,-6.660530
,3.800602
,-8.455022
,3.255833
,-4.655663
,-11.513039
,0.476487
,4.551948
,9.207186
,-8.026248
,6.781807
,7.102932
,4.965278
,7.699100
,6.244985
,-5.080855
,-9.509911
,3.946207
,2.117614
,-3.784976
,-4.955199
,-1.246659
,6.570681
,5.898156
,-7.150632
,4.600568
,8.273969
,5.806533
,-2.966947
,-5.508379
,7.457373
,5.118385
,5.648402
,9.271318
,7.784439
,8.578029
,-2.697217
,6.386467
,-13.597864
,9.006583
,-6.881824
,6.282445
,7.278602
,-3.061189
,-3.403971
,4.046764
,-8.001988
,7.860408
,-6.683003
,-1.300470
,3.174478
,7.737749
,-6.251476
,-6.964307
,-1.071166
,-1.704633
,0.147973
,4.573816
,6.703551
,-4.024460
,-4.239433
,0.297927
,5.313696
,3.795573
,-5.197054
,-3.396220
,10.336108
,5.866105
,-1.723428
,-3.227865
,-5.565100
,-5.930966
,0.046643
,-3.345658
,4.502829
,0.808901
,6.926905
,8.051465
,7.050999
,5.141909
,-3.590374
,-4.344131
,-5.739485
,2.721082
,9.664980
,-10.460854
,-4.621942
,5.748410
,7.917797
,-2.556106
,7.421867
,-4.873466
,-3.658149
,-4.851496
,-7.467458
,4.054236
,7.440071
,12.999737
,3.545926
,-10.320700
,-7.115848
,8.339463
,-3.599142
,-9.128872
,8.393800
,6.930917
,5.573819
,7.237312
,-5.629075
,0.095931
,8.744115
,-12.370199
,3.802082
,-1.215926
,-1.428002
,3.469379
,4.508451
,-7.137984
,-9.759441
,1.520548
,-7.444598
,-5.169072
,-2.429277
,5.909905
,-1.700256
,-3.676020
,-12.855274
,-10.468721
,-3.674772
,-5.799001
,2.109550
,5.177404
,-12.001925
,1.580042
,3.888405
,-5.077116
,1.514883
,4.222972
,5.766511
,-3.507904
,0.756023
,-3.153511
,6.947799
,-0.800176
,-8.324506
,5.302548
,-1.089795
,0.013540
,-1.006747
,-3.252080
,-1.274811
,-2.385136
,8.286086
,-1.463989
,-5.972889
,-4.422306
,-8.067964
,-9.808943
,-4.218743
,5.311532
,-4.693974
,1.452833
,-10.979748
,3.305918
,-10.646316
,9.442385
,7.423655
,-4.618429
,5.912899
,-9.417037
,6.071009
,3.402340
,-10.890765
,8.672248
,-11.188138
,3.709748
,-1.834947
,-10.253234
,-10.035632
,-1.836912
,-1.158531
,3.448460
,8.949100
,-4.691965
,5.576003
,4.254096
,3.906695
,3.201693
,10.575878
,-4.218753
,-1.338335
,-14.677228
,-5.911047
,-2.522079
,-11.867369
,-4.425871
,2.299673
,-1.855542
,-0.071224
,6.054165
,1.594454
,-11.182945
,-6.237494
,11.312466
,-4.640558
,6.989828
,9.038338
,-0.789098
,6.723686
,-2.654790
,6.858390
,0.296315
,-2.185428
,7.670209
,-3.412345
,9.369128
,10.579613
,-12.144822
,-8.305652
,5.382731
,1.103101
,-8.840032
,4.323966
,-1.553391
,2.321029
,4.786957
,-2.947124
,-1.880024
,-3.217823
,-6.795733
,5.363993
,-4.177831
,-6.676133
,3.951149
,4.324606
,8.360630
,6.255965
,-5.955394
,6.801110
,-3.923111
,2.840366
,2.738782
,-0.974143
,-8.275952
,6.601223
,1.594870
,7.029929
,-5.333193
,-10.425792
,1.844497
,8.052978
,14.851359
,0.031547
,-7.928531
,-7.136399
,13.296182
,0.001327
,-3.811260
,4.328132
,6.510421
,7.474461
,-8.512030
,-6.180652
,-2.139261
,-10.547683
,8.004138
,-5.057065
,5.933292
,-6.614069
,3.958126
,-5.529533
,2.088596
,-8.330948
,11.833032
,-11.470239
,9.602420
,7.861355
,11.344913
,3.559638
,-6.678444
,-4.729002
,-9.944852
,-7.317069
,9.760721
,-3.666131
,3.011467
,7.722138
,-4.515215
,1.978634
,10.124809
,-10.253444
,-1.755631
,10.078170
,-6.131429
,3.056464
,4.369453
,-4.301536
,-3.517134
,-9.996206
,11.720297
,4.566799
,-9.854290
,-10.632299
,0.233325
,-6.673870
,8.333464
,-8.399364
,-2.473936
,-4.805476
,-9.341108
,8.676817
,-6.201596
,-10.499002
,9.183017
,-3.443974
,6.724820
,5.894506
,-1.622009
,-7.516918
,8.558504
,6.457206
,-11.709766
,7.742620
,4.129478
,-6.322785
,-1.082390
,-5.285548
,5.027568
,-4.204571
,2.520962
,-8.579326
,-1.596515
,-11.188906
,6.312436
,7.932350
,2.128824
,1.222893
,-1.671528
,-8.935994
,4.194278
,6.542814
,-3.659587
,11.142365
,10.776812
,12.031786
,-1.713734
,-3.904093
,-7.684758
,5.040691
,-0.033591
,4.663963
,-4.392540
,7.414829
,-9.210044
,10.166453
,1.747455
,0.157217
,-10.815110
,6.411837
,-7.149624
,1.476321
,-5.424210
,-5.094906
,6.010161
,-4.856524
,-6.941037
,0.498529
,-4.997171
,-6.347748
,2.737654
,-5.838229
,-12.597272
,3.757539
,8.311749
,-8.437101
,2.577357
,-6.048086
,9.997652
,2.585401
,-5.519478
,-1.420144
,-5.038446
,7.515006
,7.104566
,-0.192129
,-5.939721
,-1.151686
,-4.170369
,-1.169816
,-7.139017
,-6.117581
,6.368830
,-0.338634
,-11.746200
,5.778300
,7.755205
,-3.810724
,-3.734308
,5.184843
,-6.972801
,3.450366
,7.189656
,5.822359
,9.062779
,6.392142
,3.012900
,-8.048307
,-2.560463
,7.530795
,1.955865
,4.693492
,2.841712
,10.846241
,5.903526
,7.134148
,9.458892
,-9.380718
,-5.627495
,-4.286379
,-4.613382
,-8.908841
,1.150067
,-9.937786
,-7.392566
,4.678002
,4.632996
,-6.563711
,8.486406
,-2.751134
,-1.093799
,9.271361
,-11.534271
,5.319085
,5.500939
,7.642431
,9.944507
,6.369894
,-5.739414
,-5.274531
,-3.120337
,-10.045114
,-10.037468
,-6.079272
,-4.177544
,-7.593801
,-6.627192
,-2.862799
,8.596746
,-2.315505
,2.450242
,-6.073666
,-8.221132
,-5.286231
,7.197180
,6.544978
,9.351498
,-2.707800
,-1.419666
,2.919193
,4.976567
,-7.247869
,-9.802273
,-7.872401
,8.247842
,0.806738
,-6.314035
,2.023442
,2.111939
,3.719211
,-9.739141
,9.121321
,-1.282868
,6.581152
,-2.324975
,-5.826921
,-3.922147
,-2.117419
,2.689364
,-4.093035
,5.677398
,2.595134
,1.578085
,-4.668343
,-1.579200
,8.980596
,8.990918
,-8.904274
,8.705936
,4.202024
,-9.410316
,-4.074059
,-4.671791
,7.606113
,3.634776
,-2.592285
,-5.291533
,-3.291656
,2.694350
,5.975997
,6.533463
,-3.871372
,-10.100668
,-10.649395
,10.259748
,5.604517
,0.375472
,5.487123
,-3.883315
,-5.093187
,-8.314055
,-3.809957
,-7.227268
,-7.690715
,-11.785507
,0.457306
,-7.755373
,4.150880
,-6.790907
,-2.046474
,9.770908
,3.454159
,3.916560
,-3.745900
,-4.015401
,3.035128
,-8.271742
,4.024033
,-7.571884
,-9.703747
,6.372056
,9.828748
,3.125412
,4.400095
,3.567090
,-5.432187
,5.413793
,-5.573644
,4.224636
,-2.338355
,2.152461
,-12.797834
,-8.939637
,-5.505376
,3.909469
,-4.081149
,-3.797643
,-0.164579
,9.938641
,1.818221
,-7.713235
,6.498857
,8.046349
,10.647058
,2.515944
,-4.963540
,3.357509
,-7.535059
,-5.925685
,-5.265883
,-7.832949
,-12.162105
,-4.928843
,8.015027
,-5.856152
,1.777927
,-5.511837
,-4.051584
,11.287416
,-5.298010
,5.926425
,10.551477
,2.423940
,-5.442823
,-6.188933
,8.747810
,-1.239180
,-4.689000
,2.166802
,5.064537
,-7.207042
,-5.868690
,-0.251420
,7.251498
,14.993345
,13.416835
,10.597066
,-5.243839
,5.775404
,-3.657514
,-6.084162
,0.704121
,-0.629218
,-4.351623
,8.636821
,-9.747130
,9.433764
,-2.499888
,-8.375406
,-7.669086
,4.818184
,9.683049
,-0.325031
,2.621903
,6.459511
,-7.472647
,-8.316712
,-13.152028
,5.401614
,10.318860
,-6.819017
,-6.762759
,10.207516
,9.396277
,11.884329
,-8.893838
,-10.252764
,1.352996
,-3.538032
,-3.996741
,2.908625
,4.537863
,-9.083980
,-3.572656
,-2.560380
,-6.771307
,5.937983
,1.504593
,3.320332
,-3.244201
,8.028565
,2.969663
,-8.578207
,-3.881380
,3.107068
,-9.046690
,11.680434
,7.533447
,13.036574
,11.233515
,6.579807
,-1.442676
,7.433837
,-5.748520
,-2.883669
,-5.110405
,-11.265811
,-5.031653
,1.618832
,-5.707209
,-3.708855
,4.844494
,-6.366311
,-1.321489
,0.427848
,3.328058
,-10.676762
,-11.068459
,2.428849
,3.551485
,-1.998491
,-1.822507
,1.729104
,8.484410
,3.610975
,-15.318380
,5.276912
,-9.124915
,3.450140
,1.606098
,2.726075
,-4.217871
,5.967626
,-5.748165
,0.252043
,2.006860
,8.944593
,-5.233717
,5.520798
,7.891747
,7.129079
,6.744284
,7.063122
,-2.942248
,9.660546
,-9.980138
,-1.906026
,3.570040
,3.789666
,0.544907
,3.570206
,-6.322632
,-7.111618
,-4.088518
,7.699047
,-13.556387
,9.067204
,7.439761
,2.474973
,-0.821027
,-9.617439
,-5.560234
,1.374136
,1.921732
,-4.128557
,-11.977287
,3.881265
,6.313253
,10.970212
,-1.201672
,-3.900346
,8.564359
,1.650356
,-11.154635
,-10.486271
,2.376085
,3.394677
,12.288580
,-10.012120
,-3.164555
,6.608292
,-1.271202
,6.995596
,3.047807
,1.510959
,-7.246163
,3.782410
,-4.271486
,-4.071342
,-7.132486
,3.177348
,-6.604543
,5.554842
,-3.109473
,3.436047
,-6.084560
,-2.301779
,5.042961
,-3.835239
,11.030485
,1.328424
,8.535107
,-6.560199
,-5.766591
,10.094556
,1.878367
,-2.998237
,-4.127189
,-8.573317
,4.503665
,-1.555364
,7.648731
,7.542312
,-2.927823
,-5.654630
,-5.393757
,4.302966
,8.958984
,2.695033
,4.580210
,3.704173
,-1.225689
,-4.362670
,9.067065
,-10.387863
,-0.091089
,-1.486036
,9.078730
,7.832272
,9.068650
,5.253545
,-10.367171
,8.636702
,-5.021524
,-4.011420
,-4.317496
,0.508582
,9.248055
,-6.338173
,6.220085
,-5.042432
,7.907372
,-4.687804
,-1.175592
,4.909452
,-0.704942
,2.733544
,5.281864
,-6.575294
,-13.202992
,10.925323
,6.783693
,4.458019
,-3.052408
,-4.024480
,-10.194449
,-4.862535
,-2.820059
,-0.906644
,-3.724911
,10.890901
,6.384161
,-6.809140
,6.102584
,-7.415636
,5.838809
,5.313054
,-5.279590
,8.402974
,-6.608593
,6.478348
,-2.934314
,-10.860890
,-0.368007
,6.024811
,4.521122
,-4.880118
,5.174160
,4.720798
,-2.159317
,-8.116615
,12.441380
,-1.664266
,8.451642
,6.430888
,-5.250574
,3.123380
,-9.436972
,2.035943
,6.830383
,-2.473555
,-3.650740
,-7.281087
,10.913106
,1.590603
,-4.159039
,-4.874051
,11.018597
,8.547199
,-3.393090
,-4.088890
,-5.179536
,5.968447
,6.527054
,-3.891083
,3.515144
,-4.085729
,2.350368
,7.840378
,-8.773627
,6.106099
,-5.170415
,-2.042591
,6.047926
,4.152154
,7.137157
,-5.450719
,-2.665587
,-9.034014
,6.869753
,14.201165
,7.821155
,-3.674602
,-4.999575
,-5.869449
,-4.862241
,-4.777813
,1.613205
,-6.319118
,-0.660190
,6.645930
,6.920425
,4.701375
,10.657407
,-13.377649
,-6.613187
,6.665843
,0.262312
,5.641642
,9.545387
,8.775471
,-1.846886
,-6.852926
,6.403126
,5.778589
,2.471088
,-5.243210
,-7.115195
,-5.964272
,-11.591113
,-10.259372
,-4.717716
,7.631182
,-1.645182
,-4.244583
,2.097495
,-5.798318
,2.258746
,2.936615
,2.554405
,3.266176
,-3.059049
,-8.052372
,4.289924
,5.811514
,7.843837
,-7.478490
,-0.104608
,7.560912
,7.783098
,-10.210094
,-10.577165
,-7.469728
,2.133015
,-3.775765
,-2.791593
,10.424452
,-0.166479
,-6.948217
,7.456161
,4.387598
,-4.437767
,-6.870445
,-8.299006
,-9.850477
,0.283250
,9.078971
,3.936239
,8.802215
,5.586098
,-5.270831
,11.447381
,5.049976
,8.349087
,-8.385549
,-7.034078
,-6.259573
,-0.707413
,-7.512840
,-10.018304
,6.038864
,-3.806884
,-8.771418
,4.655293
,8.740497
,-2.269086
,-3.363079
,8.245139
,-7.365153
,-3.516759
,4.674252
,7.713596
,3.408257
,10.344012
,6.964463
,5.821718
,2.910807
,-10.092989
,10.149020
,5.683465
,2.200422
,12.876844
,4.940740
,-2.296386
,-9.263885
,10.176061
,-3.045480
,1.847017
,-2.165509
,-8.195244
,5.181274
,7.246851
,-3.265843
,5.822390
,-2.755572
,-9.418820
,-8.825120
,-2.811908
,-7.392695
,-10.293430
,-6.161883
,-4.505910
,8.633694
,-6.831078
,-11.343029
,7.903757
,-5.518568
,9.741535
,-5.569709
,-9.483985
,-7.337699
,-8.749759
,-8.618569
,3.867430
,-6.208252
,0.499379
,-7.172976
,-11.344419
,-5.157281
,6.214494
,-9.830085
,7.734746
,-2.165978
,0.205466
,0.085600
,-5.582417
,-3.303458
,9.747366
,3.209116
,-8.498904
,-4.192369
,-2.236443
,-14.510044
,-0.776716
,-6.447316
,-0.529466
,-4.942501
,-8.077994
,11.815322
,-4.497931
,6.725922
,-11.200366
,6.186975
,7.870445
,5.741250
,6.685962
,-2.763307
,8.167868
,9.509506
,7.359303
,7.780214
,7.348847
,-5.759608
,-9.857200
,4.144732
,5.126996
,6.910372
,5.202849
,2.225909
,-12.334574
,6.200200
,3.872972
,-1.327495
,-4.815958
,8.493181
,1.666428
,4.192406
,7.375192
,-7.782622
,-7.683373
,-5.657664
,2.625315
,6.825225
,-4.286257
,6.111836
,3.760140
,1.027749
,7.507020
,-5.995284
,2.896484
,4.548930
,3.032564
,3.918797
,-6.231301
,-7.589929
,11.025385
,5.572937
,11.750650
,9.544246
,-3.692981
,0.061200
,-8.669365
,-3.912212
,-4.329687
,7.530131
,8.614635
,-4.634769
,6.119531
,6.167241
,-5.396747
,-7.909665
,4.741998
,2.000328
,8.000602
,-9.389755
,-7.057130
,7.023086
,-2.112905
,-0.081633
,9.257641
,-5.473392
,0.818534
,-5.960627
,-9.582827
,4.012826
,8.204728
,-6.331224
,-9.134354
,-2.771953
,-5.201409
,-2.972207
,-9.363605
,6.501665
,3.998487
,8.132317
,-4.693717
,-10.499814
,5.823205
,-5.800200
,-0.274934
,-1.271129
,7.360386
,-6.145099
,-5.107425
,-6.261947
,11.359756
,6.551913
,-7.102945
,2.942306
,4.619159
,6.316484
,-4.498108
,3.057950
,-5.284338
,5.746517
,6.536829
,-11.552956
,-10.738138
,7.417696
,5.555054
,4.250612
,-6.860183
,8.201874
,-6.362988
,7.574296
,-3.938378
,5.439003
,2.630557
,4.824768
,1.722736
,-9.537521
,-12.778864
,-5.674299
,-8.587135
,-3.046009
,-13.193257
,-5.852303
,8.615743
,7.571352
,-7.030361
,-7.884881
,6.769549
,-2.228615
,1.971981
,6.744574
,1.692538
,11.252384
,-4.349045
,2.763820
,-5.716938
,-1.613798
,-4.989385
,4.520973
,-2.276840
,1.649998
,-2.356285
,-2.831898
,-5.458385
,-9.857883
,1.822473
,-1.922590
,-2.986553
,6.659313
,1.467235
,5.471088
,-4.657330
,4.807616
,-1.482847
,-4.379218
,-5.689138
,2.899408
,5.901444
,-7.715669
,5.380238
,3.271042
,8.424106
,2.725053
,-9.266906
,-2.554296
,6.545043
,5.405558
,9.575879
,-8.656461
,-4.701077
,9.361042
,11.275444
,-6.117178
,-9.624956
,1.810341
,7.176325
,9.005525
,-8.215089
,2.535907
,7.359013
,8.088331
,-10.200776
,-12.448164
,-4.345055
,0.661608
,5.886683
,2.583262
,2.912169
,-0.478400
,-4.519132
,-7.477921
,-4.574752
,-5.986538
,-7.843964
,-7.741971
,-6.831429
,-5.099070
,0.983398
,5.113393
,7.257194
,-0.980848
,2.540373
,1.321728
,-6.129619
,14.922079
,4.807301
,-7.893583
,6.872061
,3.708652
,7.012294
,5.112410
,-4.679716
,-4.369113
,5.440710
,-8.088687
,-11.069342
,-2.812016
,-1.462663
,3.430634
,3.765604
,3.388372
,-3.592450
,-6.090887
,1.819793
,-1.822173
,-5.718309
,5.775657
,1.877458
,2.171088
,2.224563
,-7.606446
,4.711490
,-5.395107
,9.960832
,1.879439
,-8.554634
,9.685821
,-6.649584
,10.557867
,-4.048598
,1.527973
,-7.525875
,2.875383
,-6.444494
,8.304386
,3.445460
,2.429937
,-3.439023
,7.133213
,9.715428
,-0.486017
,-4.501607
,-0.050153
,-5.077881
,-4.227711
,6.260881
,-4.960546
,2.490956
,3.845315
,-0.397789
,-12.067765
,8.342977
,-6.385539
,-5.165960
,2.943848
,14.852051
,5.039518
,5.848913
,-2.208559
,-0.179229
,-8.172729
,-4.827405
,-4.183831
,-2.638209
,0.127336
,-4.470607
,3.401164
,4.963929
,5.846708
,-5.007740
,-9.299298
,7.349460
,5.047146
,-5.519622
,-6.719616
,3.259459
,-0.341035
,-3.426822
,-4.123652
,-4.854107
,-10.648832
,7.356620
,-10.062056
,-4.786649
,11.198296
,-7.487470
,-9.566434
,3.460230
,-6.861316
,-4.929912
,12.368701
,-7.856795
,-11.402271
,-7.046031
,-3.708488
,0.329126
,-5.266405
,8.027176
,-9.999560
,-2.135567
,8.497448
,4.950330
,-4.586684
,6.734442
,5.892093
,-10.744326
,5.141237
,-0.113617
,-0.072410
,-2.402923
,-1.467364
,-4.069690
,11.643632
,-0.964684
,4.481670
,-2.221663
,-3.105464
,5.212878
,0.122200
,-2.515305
,-0.324211
,3.839147
,6.405389
,-3.492821
,11.919698
,5.209524
,-6.429047
,7.593980
,-2.658672
,-6.245396
,-11.717246
,5.022526
,-8.182512
,2.416429
,-6.082213
,-6.685851
,2.483379
,-2.568443
,-12.570295
,7.641153
,9.630418
,-3.515075
,4.769844
,1.702415
,0.234192
,-7.532986
,-3.036970
,10.867967
,-4.409108
,-6.857117
,3.297359
,8.556905
,6.400545
,-4.176301
,3.994871
,-4.416701
,7.417995
,4.627842
,-4.648905
,-4.643745
,0.736198
,-2.745508
,5.074783
,-9.699204
,-7.550941
,-5.691302
,-9.182156
,-5.288776
,6.671183
,2.201115
,-4.701071
,-5.512471
,8.073342
,7.413220
,4.737795
,2.147677
,10.691515
,2.086004
,-10.590259
,-5.634385
,5.306097
,-0.461181
,-6.199220
,-5.757960
,-0.599747
,-10.552420
,3.181526
,-3.059356
,7.289803
,0.342535
,-2.489640
,2.095036
,5.195937
,7.673416
,-10.109463
,-3.242333
,-3.694728
,-13.751229
,-5.482332
,-5.146505
,5.088582
,-2.515244
,-10.285725
,1.675270
,8.880844
,-6.672819
,2.743863
,-0.759952
,8.467981
,-6.788812
,9.636202
,-5.020849
,-6.896445
,2.116287
,6.944092
,-4.067308
,1.333543
,1.657784
,-6.930704
,3.193292
,-0.264687
,-0.838920
,5.073143
,-4.826355
,-7.582592
,-4.767207
,-1.081902
,-11.519858
,-8.099331
,4.367440
,7.959513
,6.339271
,2.985970
,2.996806
,-3.791781
,-6.878367
,-7.359753
,-5.419109
,3.161452
,8.599410
,7.444306
,-6.181949
,6.865787
,-4.609097
,-3.957632
,-9.620392
,5.094422
,-3.704221
,4.065248
,5.615037
,-4.368217
,-3.996369
,4.498659
,-0.642300
,5.807686
,6.559976
,5.254293
,7.054000
,8.353182
,-0.758695
,3.020348
,-8.656406
,6.378499
,8.655843
,-4.826920
,2.857412
,3.587668
,-4.975070
,-6.905662
,-6.048104
,-11.627180
,4.116287
,-8.626194
,8.102736
,-4.753760
,2.166858
,4.819390
,-9.811942
,-6.961535
,3.282574
,3.447932
,-2.760993
,3.545333
,8.659626
,4.339166
,-1.134197
,-8.858772
,-2.192189
,-4.728108
,-3.772766
,-5.976173
,-10.351317
,-4.976782
,-2.733551
,-9.348468
,-3.644893
,2.657286
,5.263973
,-9.853719
,3.106737
,4.702267
,-1.289307
,-2.468541
,1.864197
,6.639240
,5.354551
,2.895446
,-1.176467
,-3.537393
,-7.825380
,-4.671827
,5.071218
,-8.765915
,5.901659
,-6.925971
,-14.164119
,6.729729
,9.101542
,11.375560
,-6.881464
,4.245661
,10.603621
,1.528351
,5.062334
,7.363250
,-4.576255
,9.987094
,-3.005848
,3.481034
,-4.886710
,7.922147
,2.738207
,-8.453356
,-7.216954
,-4.423234
,2.540308
,-1.849504
,5.772375
,1.566553
,7.854920
,3.250370
,9.191284
,4.300469
,4.333971
,9.020693
,10.640482
,-7.229792
,0.881592
,6.200546
,-5.384122
,-7.660528
,-3.248111
,10.623075
,6.408794
,-7.427742
,-7.780214
,3.761369
,4.653564
,-3.211180
,-4.552860
,-3.271910
,6.202818
,-5.250338
,-6.921778
,3.887586
,8.718883
,3.629888
,-6.111962
,3.887762
,12.253100
,-6.360326
,-7.596490
,4.989901
,3.936131
,-1.690082
,4.484607
,-7.467290
,3.178534
,-8.100594
,-6.149831
,-10.672243
,2.843566
,-8.475451
,-7.007798
,-11.742176
,4.395201
,-1.117637
,-12.764871
,4.302695
,-3.029600
,2.402900
,-7.611121
,5.083460
,5.685919
,5.823406
,-6.879790
,6.707773
,6.188689
,-7.868105
,-6.473433
,11.822192
,-0.140642
,-9.825990
,6.412772
,1.343736
,7.343829
,-1.917943
,7.662346
,5.589311
,-3.510317
,6.552609
,0.724804
,-7.054055
,3.657817
,7.893627
,-3.346759
,2.796788
,-8.396502
,8.605381
,11.793784
,0.324111
,-6.512761
,8.186954
,3.952115
,-1.598242};

double *llrs = data;

        ADMM_GPU_decoder_64b decoder_1( NB_FRAMES_IN_PARALLEL );
	//ADMM_GPU_Decoder decoder_1( NB_FRAMES_IN_PARALLEL );
	//ADMM_GPU_16b decoder_1( NB_FRAMES_IN_PARALLEL );

	double Eb_N0 = snr_min;

	while (Eb_N0 <= snr_max){

        //
        // ON CREE UN OBJET POUR LA MESURE DU TEMPS DE SIMULATION (REMISE A ZERO POUR CHAQUE Eb/N0)
        //
        CTimer temps_ecoule(true);
        CTimer refresh(true);

        //
        // ALLOCATION DYNAMIQUE DES DONNESS NECESSAIRES A LA SIMULATION DU SYSTEME
        //
		Encoder *encoder_1 = new CFakeEncoder(&simu_data_1);

		//
		// ON CREE LE CANAL DE COMMUNICATION (BRUIT GAUSSIEN)
		//
		CChanel *noise_1 = new CChanelAWGN2( &simu_data_1, 4, QPSK_CHANNEL, Es_N0);
		noise_1->configure( Eb_N0 );

                CErrorAnalyzer errCounter(&simu_data_1, FRAME_ERROR_LIMIT);

        //
        // ON CREE L'OBJET EN CHARGE DES INFORMATIONS DANS LE TERMINAL UTILISATEUR
        //
		CTerminal terminal(&errCounter, &temps_ecoule, Eb_N0);

        // ON GENERE LA PREMIERE TRAME BRUITEE

        double time = 0.0f;
		while( 1 ){

	        encoder_1->encode();
	        noise_1->generate();
	        errCounter.store_enc_bits();

	            //int mExeTime = 0;
		auto start   = chrono::steady_clock::now();
                //auto *data = simu_data_1.get_t_noise_data();
             
               // printf("data: %f\n", *data);

                    //decoder_1.decode(simu_data_1.get_t_noise_data(), simu_data_1.get_t_decode_data(), NOMBRE_ITERATIONS );
		    decoder_1.decode(llrs, simu_data_1.get_t_decode_data(), NOMBRE_ITERATIONS );//simu_data_1.get_t_noise_data()

                   /* int *de_code = simu_data_1.get_t_decode_data();
                    for(int m = 0; m < 100; m++){
                     printf("decode[%d]  %d\n", m, de_code[m]);
                    };*/
                  //delete de_code;
 
		auto end     = chrono::steady_clock::now();
	        time        += chrono::duration <double, milli> (end - start).count();

                errCounter.generate();

               

            //
            // ON compare le Frame Error avec la limite imposee par l'utilisateur. Si on depasse
            // alors on affiche les resultats sur Eb/N0 courant.
            //
			if ( errCounter.fe_limit_achieved() == true ){
                break;
            }

			if ( errCounter.nb_processed_frames() >= codewords ){
                break;
            }


            //
            // AFFICHAGE A L'ECRAN DE L'EVOLUTION DE LA SIMULATION SI NECESSAIRE
            //
		if( (refresh.get_time_sec()) >= 2 ){
                                                           
				refresh.reset();
            	               // terminal.temp_report();
			}
		}

		
                terminal.final_report();
              

   
               
               // ofstream outfile;
                //outfile.open("result.txt");
                //outfile << terminal.final_report() << endl;
                //outfile.close();

	           double debit = (1000.0f / (time/errCounter.nb_processed_frames())) * NOEUD / 1000.0f / 1000.0f;
	           printf("%1.2f : %1.3f Mbps\n", Eb_N0, debit);

		   Eb_N0 = Eb_N0 + snr_step;

		// ON FAIT LE MENAGE PARMIS TOUS LES OBJETS CREES DYNAMIQUEMENT...
                delete noise_1;
		delete encoder_1;
             

		// FIN DU MENAGE

        if( (simu_timer.get_time_sec() >= STOP_TIMER_SECOND) && (STOP_TIMER_SECOND != -1) )
        {
        	printf("(II) THE SIMULATION HAS STOP DUE TO THE (USER) TIME CONTRAINT.\n");
        	break;
        }

        if( BER_SIMULATION_LIMIT == true ){
        	if( errCounter.ber_value() < BIT_ERROR_LIMIT )
        	{
        		printf("(II) THE SIMULATION HAS STOP DUE TO THE (USER) QUASI-ERROR FREE CONTRAINT.\n");
        		break;
        	}
        }
	}
	return 0;
       delete [] llrs;
      
}
